[tool:pytest]
# Enhanced pytest configuration for CI/CD with rich reporting
# This configuration provides comprehensive test execution and reporting

# Test discovery
testpaths = tests
python_files = test_*.py *_test.py
python_classes = Test*
python_functions = test_*

# Minimum version requirements
minversion = 6.0

# Enhanced reporting options
addopts = 
    --strict-markers
    --strict-config
    --verbose
    --tb=short
    --cov=.
    --cov-report=term-missing
    --cov-report=html:htmlcov
    --cov-report=xml:coverage.xml
    --cov-fail-under=65
    --junitxml=test-results.xml
    --html=test-report.html
    --self-contained-html
    --durations=10
    --maxfail=5
    --tb=line
    --color=yes
    --capture=no
    --ci-summary
    --strict-markers
    --disable-warnings
    --tb=short
    --show-capture=no

# Comprehensive test markers
markers =
    # Test Types
    unit: Unit tests that test individual functions/methods
    integration: Integration tests that test component interactions
    functional: Functional tests that test end-to-end workflows
    performance: Performance tests for large datasets
    edge_case: Tests for edge cases and error conditions
    
    # Test Categories
    critical: Critical functionality that must always pass
    regression: Tests that prevent regression of fixed bugs
    slow: Tests that take longer to run
    ci_only: Tests that should only run in CI/CD environment
    
    # Component Categories
    extractors: Tests for data extractors
    database: Tests for database operations
    configuration: Tests for configuration management
    api: Tests for API endpoints
    data_extraction: Tests for data extraction logic
    gap_analysis: Tests for gap analysis functionality
    frontend: Tests for frontend data handling
    
    # Data Processing Categories
    risk_extraction: Tests for risk data extraction
    control_extraction: Tests for control data extraction
    question_extraction: Tests for question data extraction
    mapping_extraction: Tests for mapping data extraction
    
    # Quality Categories
    data_validation: Tests for data validation
    error_handling: Tests for error handling
    performance: Tests for performance characteristics
    security: Tests for security aspects

# Coverage configuration
[coverage:run]
source = .
omit = 
    tests/*
    venv/*
    .venv/*
    __pycache__/*
    */__pycache__/*
    */tests/*
    */test_*
    setup.py
    conftest.py
    app.py
    enhanced_data_processor.py
    processors/*
    utils/*
    generate_test_summary.py
    run_tests_with_summary.py
    simple_test_summary.py
    test_runner.sh
    ci_test_summary.sh

[coverage:report]
exclude_lines =
    pragma: no cover
    def __repr__
    if self.debug:
    if settings.DEBUG
    raise AssertionError
    raise NotImplementedError
    if 0:
    if __name__ == .__main__.:
    class .*\bProtocol\):
    @(abc\.)?abstractmethod

# Coverage thresholds
fail_under = 65
show_missing = True
skip_covered = False
skip_empty = False

# HTML report configuration
html_dir = htmlcov
html_title = Data Processing Service Coverage Report

# XML report configuration
xml_output = coverage.xml

# Test timeout configuration
timeout = 300
timeout_method = thread
